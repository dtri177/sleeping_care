<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <%- include('partials/css') %>


        <title>Home</title>
</head>


<body>
    <%- include('partials/header') %>
        <%- include('partials/sidebar') %>
            <main class="main">
                <div class="container-fluid">
                    <!-- slider -->


                    <section class="row">
                        <div class="col-12">
                            <div class="hero owl-carousel" id="hero">
                                <div class="hero__slide" data-bg="img/home/sleep_1.png">


                                    <h2 class="hero__title">Sleep Care</h2>
                                    <p class="hero__text">It also features Rage Against The Machine, Guns N' Roses and a
                                        number of others</p>
                                    <div class="hero__btns">
                                        <%- include('partials/pay') %>




                                    </div>
                                </div>
                            </div>


                           
                        </div>
                    </section>


                    <!-- end slider -->
                    <%- include('partials/chatbox') %>




                            <div class="audio-player">
                                <audio hidden id="audioPlayer" controls></audio>
                               
                                <button id="playPauseBtn">▶</button>
                                <span id="currentTime">0:00</span> /
                                <span id="duration">0:00</span>
                           
                                <input type="range" id="progressBar" value="0" min="0" step="1">
                           
                                <button id="muteBtn">🔊</button>
                                <input type="range" id="volumeBar" min="0" max="1" step="0.1" value="1">
                               
                            </div>


                            <!-- releases -->
                            <section class="row row--grid">
                                <!-- title -->
                          
                                <!-- end title -->


                            <% sounds.forEach(sound=> { %>
                               
                                <div class="col-6 col-sm-4 col-lg-2">
                                    <div class="album">
                                        <div class="album__cover">
                                            <img src="<%= sound.images %>" alt="Cover Image">
                                            <a onclick="playSound('<%= sound.preview %>')"><svg xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 24 24">
                                                    <path
                                                        d="M18.54,9,8.88,3.46a3.42,3.42,0,0,0-5.13,3V17.58A3.42,3.42,0,0,0,7.17,21a3.43,3.43,0,0,0,1.71-.46L18.54,15a3.42,3.42,0,0,0,0-5.92Zm-1,4.19L7.88,18.81a1.44,1.44,0,0,1-1.42,0,1.42,1.42,0,0,1-.71-1.23V6.42a1.42,1.42,0,0,1,.71-1.23A1.51,1.51,0,0,1,7.17,5a1.54,1.54,0,0,1,.71.19l9.66,5.58a1.42,1.42,0,0,1,0,2.46Z" />
                                                </svg></a>
												
                                            <!-- <span class="album__stat">
                                                <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                                        <path
                                                            d="M3.71,16.29a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21,1,1,0,0,0-.21.33,1,1,0,0,0,.21,1.09,1.15,1.15,0,0,0,.33.21.94.94,0,0,0,.76,0,1.15,1.15,0,0,0,.33-.21,1,1,0,0,0,.21-1.09A1,1,0,0,0,3.71,16.29ZM7,8H21a1,1,0,0,0,0-2H7A1,1,0,0,0,7,8ZM3.71,11.29a1,1,0,0,0-1.09-.21,1.15,1.15,0,0,0-.33.21,1,1,0,0,0-.21.33.94.94,0,0,0,0,.76,1.15,1.15,0,0,0,.21.33,1.15,1.15,0,0,0,.33.21.94.94,0,0,0,.76,0,1.15,1.15,0,0,0,.33-.21,1.15,1.15,0,0,0,.21-.33.94.94,0,0,0,0-.76A1,1,0,0,0,3.71,11.29ZM21,11H7a1,1,0,0,0,0,2H21a1,1,0,0,0,0-2ZM3.71,6.29a1,1,0,0,0-.33-.21,1,1,0,0,0-1.09.21,1.15,1.15,0,0,0-.21.33.94.94,0,0,0,0,.76,1.15,1.15,0,0,0,.21.33,1.15,1.15,0,0,0,.33.21,1,1,0,0,0,1.09-.21,1.15,1.15,0,0,0,.21-.33.94.94,0,0,0,0-.76A1.15,1.15,0,0,0,3.71,6.29ZM21,16H7a1,1,0,0,0,0,2H21a1,1,0,0,0,0-2Z" />
                                                    </svg></span>
                                                <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                                        <path
                                                            d="M20,13.18V11A8,8,0,0,0,4,11v2.18A3,3,0,0,0,2,16v2a3,3,0,0,0,3,3H8a1,1,0,0,0,1-1V14a1,1,0,0,0-1-1H6V11a6,6,0,0,1,12,0v2H16a1,1,0,0,0-1,1v6a1,1,0,0,0,1,1h3a3,3,0,0,0,3-3V16A3,3,0,0,0,20,13.18ZM7,15v4H5a1,1,0,0,1-1-1V16a1,1,0,0,1,1-1Zm13,3a1,1,0,0,1-1,1H17V15h2a1,1,0,0,1,1,1Z" />
                                                    </svg> 19 503</span>
                                            </span> -->
                                        </div>
                                        <div class="album__title">
                                            <h3><%= sound.name %></h3>
                                            <span><%= sound.duration %></span>
											<a href="/user/fav/<%= sound._id %>" class="favorite-btn">
												<i class="fas fa-heart"></i>
											</a>
                                        </div>
                                    </div>
                                </div>
                            <% }); %>
                            </section>
                            <!-- end releases -->


                            <!-- events -->
                            <section class="row row--grid">
                                <!-- title -->
                           
                                <!-- end title -->


                                
                            </section>
                            <!-- end events -->


                           

                            <!-- store -->
                            <section class="row row--grid">
                                <!-- title -->
                               
                                <!-- end title -->


                                
                            </section>
                            <!-- end store -->


                            <!-- news -->
                          
                            <!-- end news -->


                            <!-- partners -->
                            
                            <!-- end partners -->


                </div>




            </main>




            <%- include('partials/footer') %>
                <!-- <script>
                    function playSound(soundId) {
                        fetch(`/play/${soundId}`)
                            .then(response => response.json())
                            .then(data => {
                                let audio = document.getElementById("audioPlayer");
                                audio.src = data.audioUrl;
                                audio.play();
                            })
                            .catch(error => console.error("Lỗi khi phát âm thanh:", error));
                    }


                    document.querySelectorAll(".hero__slide").forEach(slide => {
                        let bg = slide.getAttribute("data-bg");
                        if (bg) {
                            slide.style.backgroundImage = `url(${bg})`;
                        }
                    });


                </script> -->


                <script>
                    document.addEventListener("DOMContentLoaded", function () {
                        const audio = document.getElementById("audioPlayer");
                        const audioContainer = document.querySelector(".audio-player");
                        const playPauseBtn = document.getElementById("playPauseBtn");
                        const progressBar = document.getElementById("progressBar");
                        const currentTimeDisplay = document.getElementById("currentTime");
                        const durationDisplay = document.getElementById("duration");
                        const muteBtn = document.getElementById("muteBtn");
                        const volumeBar = document.getElementById("volumeBar");
           
                        function playSound(url) {
                            if (audio.src !== url) {
                                audio.src = url;
                            }
                            audio.play();
                            audioContainer.style.display = "flex";
                            playPauseBtn.textContent = "⏸";
                        }
           
                        playPauseBtn.addEventListener("click", () => {
                            if (audio.paused) {
                                audio.play();
                                playPauseBtn.textContent = "⏸";
                            } else {
                                audio.pause();
                                playPauseBtn.textContent = "▶";
                            }
                        });
           
                        audio.addEventListener("timeupdate", () => {
                            progressBar.value = (audio.currentTime / audio.duration) * 100;
                            currentTimeDisplay.textContent = formatTime(audio.currentTime);
                        });
           
                        audio.addEventListener("loadedmetadata", () => {
                            durationDisplay.textContent = formatTime(audio.duration);
                        });
           
                        progressBar.addEventListener("input", () => {
                            audio.currentTime = (progressBar.value / 100) * audio.duration;
                        });
           
                        muteBtn.addEventListener("click", () => {
                            audio.muted = !audio.muted;
                            muteBtn.textContent = audio.muted ? "🔇" : "🔊";
                        });
           
                        volumeBar.addEventListener("input", () => {
                            audio.volume = volumeBar.value;
                        });


                        audio.addEventListener("ended", () => {
                            audioContainer.style.display = "none";
                        });
           
                        function formatTime(seconds) {
                            let mins = Math.floor(seconds / 60);
                            let secs = Math.floor(seconds % 60);
                            return `${mins}:${secs < 10 ? "0" : ""}${secs}`;
                        }
           
                        window.playSound = playSound;
                    });
           
                    document.querySelectorAll(".hero__slide").forEach(slide => {
                        let bg = slide.getAttribute("data-bg");
                        if (bg) {
                            slide.style.backgroundImage = `url(${bg})`;
                        }
                    });
                </script>
</body>


</html>
